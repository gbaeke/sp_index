<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 1906.64px; background-color: white;" viewBox="0 0 1906.640625 180.9976348876953" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M103.797,139L119.177,139C134.557,139,165.318,139,196.078,139C226.839,139,257.599,139,272.979,139L288.359,139" id="L_U_TUI_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_U_TUI_0" data-points="W3sieCI6OTkuNzk2ODc1LCJ5IjoxMzl9LHsieCI6MTk2LjA3ODEyNSwieSI6MTM5fSx7IngiOjI5Mi4zNTkzNzUsInkiOjEzOX1d" marker-start="url(#my-svg_flowchart-v2-pointStart)" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M437.236,129.965L455.034,127.804C472.832,125.643,508.428,121.322,544.022,121.083C579.617,120.844,615.211,124.688,633.008,126.61L650.804,128.531" id="L_TUI_Agent_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_TUI_Agent_0" data-points="W3sieCI6NDMzLjI2NTYyNSwieSI6MTMwLjQ0NjYwNDg3MTczOTZ9LHsieCI6NTQ0LjAyMzQzNzUsInkiOjExN30seyJ4Ijo2NTQuNzgxMjUsInkiOjEyOC45NjA5NjAyNjk5ODAwNn1d" marker-start="url(#my-svg_flowchart-v2-pointStart)" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M840.703,127.378L854.538,125.648C868.372,123.919,896.042,120.459,927.906,120.908C959.77,121.358,995.829,125.715,1013.859,127.894L1031.888,130.073" id="L_Agent_MCP_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Agent_MCP_0" data-points="W3sieCI6ODQwLjcwMzEyNSwieSI6MTI3LjM3NzgxOTIxNTA1OTQ5fSx7IngiOjkyMy43MTA5Mzc1LCJ5IjoxMTd9LHsieCI6MTAzNS44NTkzNzUsInkiOjEzMC41NTI5MTM5MTI5Njg4NX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1175.656,126.954L1193.021,123.962C1210.385,120.97,1245.115,114.985,1279.214,114.636C1313.313,114.287,1346.783,119.575,1363.517,122.219L1380.252,124.862" id="L_MCP_Search_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_MCP_Search_0" data-points="W3sieCI6MTE3NS42NTYyNSwieSI6MTI2Ljk1NDQ5NDQ1NzY1ODN9LHsieCI6MTI3OS44NDM3NSwieSI6MTA5fSx7IngiOjEzODQuMjAzMTI1LCJ5IjoxMjUuNDg2NjA4Nzk1ODIwMTN9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1384.203,148.91L1366.81,150.925C1349.417,152.94,1314.63,156.97,1280.534,156.874C1246.437,156.778,1213.031,152.557,1196.328,150.446L1179.625,148.335" id="L_Search_MCP_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Search_MCP_0" data-points="W3sieCI6MTM4NC4yMDMxMjUsInkiOjE0OC45MDk4MjAyMTYzOTg1N30seyJ4IjoxMjc5Ljg0Mzc1LCJ5IjoxNjF9LHsieCI6MTE3NS42NTYyNSwieSI6MTQ3LjgzMzM3MDczMTA1MDU2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1035.859,147.447L1017.168,149.706C998.477,151.965,961.094,156.482,929.229,157.094C897.365,157.706,871.018,154.412,857.845,152.765L844.672,151.118" id="L_MCP_Agent_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_MCP_Agent_0" data-points="W3sieCI6MTAzNS44NTkzNzUsInkiOjE0Ny40NDcwODYwODcwMzExNX0seyJ4Ijo5MjMuNzEwOTM3NSwieSI6MTYxfSx7IngiOjg0MC43MDMxMjUsInkiOjE1MC42MjIxODA3ODQ5NDA1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M654.781,149.039L636.322,151.033C617.862,153.026,580.943,157.013,544.685,156.846C508.428,156.678,472.832,152.357,455.034,150.196L437.236,148.035" id="L_Agent_TUI_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Agent_TUI_0" data-points="W3sieCI6NjU0Ljc4MTI1LCJ5IjoxNDkuMDM5MDM5NzMwMDE5OTR9LHsieCI6NTQ0LjAyMzQzNzUsInkiOjE2MX0seyJ4Ijo0MzMuMjY1NjI1LCJ5IjoxNDcuNTUzMzk1MTI4MjYwNH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1204.797,35L1217.305,35C1229.813,35,1254.828,35,1279.177,35C1303.526,35,1327.208,35,1339.049,35L1350.891,35" id="L_SharePoint_Indexer_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_SharePoint_Indexer_0" data-points="W3sieCI6MTIwNC43OTY4NzUsInkiOjM1fSx7IngiOjEyNzkuODQzNzUsInkiOjM1fSx7IngiOjEzNTQuODkwNjI1LCJ5IjozNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1584.594,35L1596.618,35C1608.643,35,1632.693,35,1656.153,41.069C1679.614,47.138,1702.486,59.277,1713.922,65.346L1725.357,71.415" id="L_Indexer_Index_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Indexer_Index_0" data-points="W3sieCI6MTU4NC41OTM3NSwieSI6MzV9LHsieCI6MTY1Ni43NDIxODc1LCJ5IjozNX0seyJ4IjoxNzI4Ljg5MDYyNSwieSI6NzMuMjkwNTI1NzIyOTQ3MDh9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1555.281,139L1572.191,139C1589.102,139,1622.922,139,1651.268,132.931C1679.614,126.862,1702.486,114.723,1713.922,108.654L1725.357,102.585" id="L_Search_Index_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Search_Index_0" data-points="W3sieCI6MTU1NS4yODEyNSwieSI6MTM5fSx7IngiOjE2NTYuNzQyMTg3NSwieSI6MTM5fSx7IngiOjE3MjguODkwNjI1LCJ5IjoxMDAuNzA5NDc0Mjc3MDUyOTJ9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(196.078125, 139)"><g class="label" data-id="L_U_TUI_0" transform="translate(-71.28125, -12)"><foreignObject width="142.5625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>questions / answers</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(544.0234375, 117)"><g class="label" data-id="L_TUI_Agent_0" transform="translate(-85.7578125, -12)"><foreignObject width="171.515625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>prompt + stream tokens</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(938.26026, 118.75826)"><g class="label" data-id="L_Agent_MCP_0" transform="translate(-58.0078125, -12)"><foreignObject width="116.015625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>tool call: search</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1279.80946, 109.00591)"><g class="label" data-id="L_MCP_Search_0" transform="translate(-35.9140625, -12)"><foreignObject width="71.828125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>ACL query</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1279.86422, 160.99763)"><g class="label" data-id="L_Search_MCP_0" transform="translate(-23.8515625, -12)"><foreignObject width="47.703125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>results</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(938.26026, 159.24174)"><g class="label" data-id="L_MCP_Agent_0" transform="translate(-37.140625, -12)"><foreignObject width="74.28125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>tool result</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(543.93941, 160.9898)"><g class="label" data-id="L_Agent_TUI_0" transform="translate(-50.015625, -12)"><foreignObject width="100.03125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>final response</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1279.84375, 35)"><g class="label" data-id="L_SharePoint_Indexer_0" transform="translate(-50.046875, -12)"><foreignObject width="100.09375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>crawl + ingest</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1656.7421875, 35)"><g class="label" data-id="L_Indexer_Index_0" transform="translate(-47.1484375, -12)"><foreignObject width="94.296875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>build/update</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1656.7421875, 139)"><g class="label" data-id="L_Search_Index_0" transform="translate(-42.140625, -12)"><foreignObject width="84.28125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>query index</p></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-U-0" transform="translate(53.8984375, 139)"><rect class="basic label-container" style="" x="-45.8984375" y="-27" width="91.796875" height="54"/><g class="label" style="" transform="translate(-15.8984375, -12)"><rect/><foreignObject width="31.796875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>User</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-TUI-1" transform="translate(362.8125, 139)"><rect class="basic label-container" style="" x="-70.453125" y="-27" width="140.90625" height="54"/><g class="label" style="" transform="translate(-40.453125, -12)"><rect/><foreignObject width="80.90625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Textual TUI</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Agent-3" transform="translate(747.7421875, 139)"><rect class="basic label-container" style="" x="-92.9609375" y="-27" width="185.921875" height="54"/><g class="label" style="" transform="translate(-62.9609375, -12)"><rect/><foreignObject width="125.921875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Agent Framework</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-MCP-5" transform="translate(1105.7578125, 139)"><rect class="basic label-container" style="" x="-69.8984375" y="-27" width="139.796875" height="54"/><g class="label" style="" transform="translate(-39.8984375, -12)"><rect/><foreignObject width="79.796875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>MCP Server</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Search-7" transform="translate(1469.7421875, 139)"><rect class="basic label-container" style="" x="-85.5390625" y="-27" width="171.078125" height="54"/><g class="label" style="" transform="translate(-55.5390625, -12)"><rect/><foreignObject width="111.078125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Azure AI Search</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-SharePoint-14" transform="translate(1105.7578125, 35)"><rect class="basic label-container" style="" x="-99.0390625" y="-27" width="198.078125" height="54"/><g class="label" style="" transform="translate(-69.0390625, -12)"><rect/><foreignObject width="138.078125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>SharePoint Content</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Indexer-15" transform="translate(1469.7421875, 35)"><rect class="basic label-container" style="" x="-114.8515625" y="-27" width="229.703125" height="54"/><g class="label" style="" transform="translate(-84.8515625, -12)"><rect/><foreignObject width="169.703125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Azure AI Search Indexer</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Index-17" transform="translate(1813.765625, 87)"><path d="M0,14.397794741306193 a84.875,14.397794741306193 0,0,0 169.75,0 a84.875,14.397794741306193 0,0,0 -169.75,0 l0,53.39779474130619 a84.875,14.397794741306193 0,0,0 169.75,0 l0,-53.39779474130619" class="basic label-container" style="" transform="translate(-84.875, -41.096692111959285)"/><g class="label" style="" transform="translate(-77.375, -2)"><rect/><foreignObject width="154.75" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Azure AI Search Index</p></span></div></foreignObject></g></g></g></g></g></svg>